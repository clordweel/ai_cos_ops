---
description: "迁移规范：从 dev 到 prod 的谨慎流程与护栏"
alwaysApply: true
---

## 迁移总原则

- dev/prod 数据差异巨大：**不要假设 dev 的数据/配置能直接覆盖到 prod**。
- 任何迁移都必须可追溯、可回滚、可验证。

## 必须输出的三件事

在给出迁移方案前，必须明确：

1. **迁移对象**：哪些 DocType/配置/脚本/patch
2. **回滚方案**：怎么撤销、撤销会不会丢数据
3. **验证步骤**：如何确认成功与无副作用（含关键报表/关键业务流程）

## 必做检查（摘要）

- 在 dev 演练并记录步骤（命令/请求/结果）。
- 产出“可迁移工件”（fixtures/patches/配置变更记录），并对其进行 code review。
- 生产执行前再次确认环境（`scripts/preflight.py --env prod`）并启用双确认护栏。

详见：`docs/migration.md`

